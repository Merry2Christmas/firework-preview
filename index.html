<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>ç²’å­æ‰‹åŠ¿æ˜Ÿç©ºä¹¦ Â· çœŸå®çƒŸèŠ±</title>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        background: #000;
        overflow: hidden;
        touch-action: none; /* ğŸ”¥ å…³é”®ï¼šé˜²æ­¢æ‰‹æœºæ»‘åŠ¨é¡µé¢ */
      }
      canvas {
        display: block;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas"></canvas>

    <script>
      /* ================= åŸºç¡€è®¾ç½® ================= */
      const canvas = document.getElementById('canvas')
      const ctx = canvas.getContext('2d')

      function resize() {
        canvas.width = window.innerWidth
        canvas.height = window.innerHeight
      }
      resize()
      window.addEventListener('resize', resize)

      /* ================= æ˜Ÿç©º ================= */
      const stars = []
      for (let i = 0; i < 200; i++) {
        stars.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          r: Math.random() * 1.8,
          a: Math.random(),
        })
      }

      /* ================= ç²’å­ï¼ˆåŠ ç²— 3 å€ï¼‰ ================= */
      class Particle {
        constructor(x, y, color) {
          const angle = Math.random() * Math.PI * 2
          const speed = Math.random() * 6 + 3

          this.x = x
          this.y = y
          this.vx = Math.cos(angle) * speed
          this.vy = Math.sin(angle) * speed

          this.prevX = x
          this.prevY = y

          this.alpha = 1
          this.color = color
          this.gravity = 0.06
          this.friction = 0.985

          this.width = 7.2 // ğŸ”¥ ç²’å­çº¿æ®µåŠ ç²—ä¸‰å€
        }

        update() {
          this.prevX = this.x
          this.prevY = this.y

          this.vx *= this.friction
          this.vy *= this.friction
          this.vy += this.gravity

          this.x += this.vx
          this.y += this.vy

          this.alpha -= 0.018
        }

        draw() {
          ctx.save()
          ctx.globalAlpha = this.alpha
          ctx.strokeStyle = this.color
          ctx.lineWidth = this.width
          ctx.lineCap = 'round'
          ctx.beginPath()
          ctx.moveTo(this.prevX, this.prevY)
          ctx.lineTo(this.x, this.y)
          ctx.stroke()
          ctx.restore()
        }
      }

      /* ================= çƒŸèŠ± ================= */
      class Firework {
        constructor(x, y) {
          this.x = x
          this.y = canvas.height
          this.targetY = y
          this.speed = 8
          this.exploded = false
          this.particles = []
          this.color = `hsl(${Math.random() * 360}, 100%, 65%)`
        }

        update() {
          if (!this.exploded) {
            this.y -= this.speed
            if (this.y <= this.targetY) {
              this.explode()
              this.exploded = true
            }
          } else {
            this.particles.forEach((p) => p.update())
          }
        }

        explode() {
          const count = 90
          for (let i = 0; i < count; i++) {
            this.particles.push(new Particle(this.x, this.y, this.color))
          }
        }

        draw() {
          if (!this.exploded) {
            ctx.fillStyle = '#fff'
            ctx.fillRect(this.x, this.y, 3, 14)
          } else {
            this.particles.forEach((p) => p.draw())
          }
        }

        done() {
          return this.exploded && this.particles.every((p) => p.alpha <= 0)
        }
      }

      /* ================= äº¤äº’ï¼ˆé¼ æ ‡ + è§¦æ‘¸ï¼‰ ================= */
      const fireworks = []
      let isInteracting = false

      function launch(x, y) {
        fireworks.push(new Firework(x, y))
      }

      /* é¼ æ ‡ */
      canvas.addEventListener('mousedown', (e) => {
        isInteracting = true
        launch(e.clientX, e.clientY)
      })

      canvas.addEventListener('mousemove', (e) => {
        if (isInteracting) launch(e.clientX, e.clientY)
      })

      window.addEventListener('mouseup', () => {
        isInteracting = false
      })

      /* è§¦æ‘¸ */
      canvas.addEventListener('touchstart', (e) => {
        e.preventDefault()
        isInteracting = true
        const t = e.touches[0]
        launch(t.clientX, t.clientY)
      })

      canvas.addEventListener('touchmove', (e) => {
        e.preventDefault()
        if (!isInteracting) return
        const t = e.touches[0]
        launch(t.clientX, t.clientY)
      })

      canvas.addEventListener('touchend', () => {
        isInteracting = false
      })

      /* ================= åŠ¨ç”»å¾ªç¯ ================= */
      function animate() {
        requestAnimationFrame(animate)

        ctx.fillStyle = 'rgba(0, 0, 0, 0.28)'
        ctx.fillRect(0, 0, canvas.width, canvas.height)

        stars.forEach((s) => {
          s.a += (Math.random() - 0.5) * 0.02
          s.a = Math.max(0.3, Math.min(1, s.a))
          ctx.globalAlpha = s.a
          ctx.fillStyle = '#fff'
          ctx.beginPath()
          ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2)
          ctx.fill()
        })
        ctx.globalAlpha = 1

        fireworks.forEach((f, i) => {
          f.update()
          f.draw()
          if (f.done()) fireworks.splice(i, 1)
        })
      }

      animate()
    </script>
  </body>
</html>
